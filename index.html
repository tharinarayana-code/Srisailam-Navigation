<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="stylesheet" href="style2.css">
  <meta charset="UTF-8">
  <title>Srisailam Smart Navigation</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <link rel="icon" type="image/png" href="logo.jpg">
  <style>
      /* --- FOOTER CREDITS STYLING (Subtle/Hidden mode) --- */
      .dev-credit {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    color: #666; /* Changed from #999 to #666 for darker, more visible text */
    text-decoration: none;
    font-weight: normal;
    transition: all 0.2s ease;
    padding: 0 4px;
}

      /* Only show color when someone actually hovers over it */
      .dev-credit:hover {
          color: #0077b5; 
          opacity: 1;
      }

      .dev-credit svg {
    width: 14px; /* Increased from 12px to 14px */
    height: 14px; /* Increased from 12px to 14px */
    fill: currentColor;
    position: relative;
    top: -1px; 
}

      .divider {
          color: #ddd; /* Very faint divider */
          margin: 0 3px;
      }
      
      /* Wrapper to push it to bottom */
      #developer-credits {
    margin-top: 25px; 
    padding-top: 10px;
    border-top: 1px solid #f0f0f0;
    font-size: 14px; /* Increased from 11px to 14px */
    opacity: 0.85; /* Increased from 0.6 to 0.85 */
}
      
      #developer-credits:hover {
          opacity: 1; /* Make it visible if they intentionally look at it */
      }
  </style>
</head>
<body id="top">
<header>
  <h1 id="app-title">Srisailam Area Navigation</h1>
  <h4 id="app-subtitle">Select category ‚Üí choose place ‚Üí navigate</h4>
  
  <div id="language-selector">
      <label id="lang-label" for="lang">Language:</label>
      <select id="lang">
          <option value="en">English</option>
          <option value="te">‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å</option>
          <option value="hi">‡§π‡§ø‡§Ç‡§¶‡•Ä</option>
          <option value="ta">‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç</option>
          <option value="kn">‡≤ï‡≤®‡≥ç‡≤®‡≤°</option>
          <option value="ml">‡¥Æ‡¥≤‡¥Ø‡¥æ‡¥≥‡¥Ç</option>
      </select>
  </div>
  <div id="search-box">
      <div style="position: relative; max-width: 500px; margin: 0 auto;">
          <input
              type="text"
              id="searchInput"
              placeholder="Search places, food, temples‚Ä¶"
          />
          <button 
              id="clearSearch" 
              type="button"
              style="display: none;"
              aria-label="Clear search"
          >‚úï</button>
      </div>
  </div>
  <div id="free-darshan-container" style="margin: 15px 0;"></div>
</header>
</header> 
<div id="hero-section" style="
    max-width: 600px; 
    margin: 10px auto 20px auto; 
    padding: 0 15px; 
    text-align: center;
">
    <div style="
        position: relative;
        border-radius: 15px; 
        overflow: hidden; 
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        border: 2px solid #fff;
    ">
        <img 
            src="temple_banner.jpeg" 
            alt="Srisailam Mallikarjuna Swamy Temple" 
            style="
                width: 100%; 
                height: 200px; /* Fixed height for consistency */
                object-fit: cover; /* Ensures image covers area without stretching */
                display: block;
            "
        >
    </div>
</div>
<main id="app"></main>

<section id="search-results" style="display:none;">
  <h2 id="search-title">Search Results</h2>
  <ul id="search-list"></ul>
</section>

<a href="#top" id="back-to-top" aria-label="Back to top">
  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round" stroke-linejoin="round">
    <line x1="12" y1="30" x2="12" y2="5"></line>
    <polyline points="5 12 12 5 19 12"></polyline>
  </svg>
</a>

<footer id="temple-footer">
    <p id="footer-note" style="font-size: 13px; color: #777; text-align:center;">
        Navigation is provided via Google Maps. Routes may vary based on traffic and conditions.
    </p>

    <p id="footer-update" style="font-size: 13px; color: #777; text-align:center;">
        Last updated: December 2025
    </p>

    <div id="developer-credits" style="text-align: center; display: flex; justify-content: center; align-items: center; flex-wrap: wrap;">
        <span style="margin-right: 4px;">Developed by: </span>
        
        <a href="https://www.linkedin.com/in/bhodini-gundu" target="_blank" class="dev-credit">
            <svg viewBox="0 0 24 24"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/></svg>
            Gundu Bhodini
        </a>
    
        <span class="divider">|</span>

        <a href="https://www.linkedin.com/in/aditya-karre" target="_blank" class="dev-credit">
            <svg viewBox="0 0 24 24"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/></svg>
            Aditya Karre
        </a>

    </div>
</footer>

<script>
/* ================= GLOBAL STATE ================= */
let locationsData = [];
let currentLang = "en";
let searchQuery = "";

/* ================= STATIC UI TRANSLATIONS ================= */
const STATIC_TRANSLATIONS = {
  title: {
    en: "Srisailam Area Navigation",
    te: "‡∞∂‡±ç‡∞∞‡±Ä‡∞∂‡±à‡∞≤‡∞Ç ‡∞™‡±ç‡∞∞‡∞æ‡∞Ç‡∞§ ‡∞®‡∞æ‡∞µ‡∞ø‡∞ó‡±á‡∞∑‡∞®‡±ç",
    hi: "‡§∂‡•ç‡§∞‡•Ä‡§∂‡•à‡§≤‡§Æ ‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞ ‡§®‡•á‡§µ‡§ø‡§ó‡•á‡§∂‡§®",
    ta: "‡Æ∏‡Øç‡Æ∞‡ØÄ‡Æö‡Øà‡Æ≤‡ÆÆ‡Øç ‡Æ™‡Æï‡ØÅ‡Æ§‡Æø ‡Æµ‡Æ¥‡Æø‡Æö‡ØÜ‡Æ≤‡ØÅ‡Æ§‡Øç‡Æ§‡Æ≤‡Øç",
    kn: "‡≤∂‡≥ç‡≤∞‡≥Ä‡≤∂‡≥à‡≤≤‡≤Ç ‡≤™‡≥ç‡≤∞‡≤¶‡≥á‡≤∂ ‡≤®‡≥ç‡≤Ø‡≤æ‡≤µ‡≤ø‡≤ó‡≥á‡≤∑‡≤®‡≥ç",
    ml: "‡¥∂‡µç‡¥∞‡µÄ‡¥∂‡µà‡¥≤‡¥Ç ‡¥è‡¥∞‡¥ø‡¥Ø ‡¥®‡¥æ‡¥µ‡¥ø‡¥ó‡µá‡¥∑‡µª"
  },
  subtitle: {
    en: "Select category ‚Üí choose place ‚Üí navigate",
    te: "‡∞µ‡∞∞‡±ç‡∞ó‡∞æ‡∞®‡±ç‡∞®‡∞ø ‡∞é‡∞Ç‡∞ö‡±Å‡∞ï‡±ã‡∞Ç‡∞°‡∞ø ‚Üí ‡∞∏‡±ç‡∞•‡∞≤‡∞æ‡∞®‡±ç‡∞®‡∞ø ‡∞é‡∞Ç‡∞ö‡±Å‡∞ï‡±ã‡∞Ç‡∞°‡∞ø ‚Üí ‡∞®‡∞æ‡∞µ‡∞ø‡∞ó‡±á‡∞ü‡±ç ‡∞ö‡±á‡∞Ø‡∞Ç‡∞°‡∞ø",
    hi: "‡§∂‡•ç‡§∞‡•á‡§£‡•Ä ‡§ö‡•Å‡§®‡•á‡§Ç ‚Üí ‡§∏‡•ç‡§•‡§æ‡§® ‡§ö‡•Å‡§®‡•á‡§Ç ‚Üí ‡§®‡•á‡§µ‡§ø‡§ó‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç",
    ta: "‡Æµ‡Æï‡Øà‡ÆØ‡Øà‡Æ§‡Øç ‡Æ§‡Øá‡Æ∞‡Øç‡Æ®‡Øç‡Æ§‡ØÜ‡Æü‡ØÅ‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç ‚Üí ‡Æá‡Æü‡Æ§‡Øç‡Æ§‡Øà‡Æ§‡Øç ‡Æ§‡Øá‡Æ∞‡Øç‡Æ®‡Øç‡Æ§‡ØÜ‡Æü‡ØÅ‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç ‚Üí ‡Æµ‡Æ¥‡Æø‡Æï‡Ææ‡Æü‡Øç‡Æü‡Æµ‡ØÅ‡ÆÆ‡Øç",
    kn: "‡≤µ‡≤∞‡≥ç‡≤ó‡≤µ‡≤®‡≥ç‡≤®‡≥Å ‡≤Ü‡≤Ø‡≥ç‡≤ï‡≥Ü‡≤Æ‡≤æ‡≤°‡≤ø ‚Üí ‡≤∏‡≥ç‡≤•‡≤≥‡≤µ‡≤®‡≥ç‡≤®‡≥Å ‡≤Ü‡≤Ø‡≥ç‡≤ï‡≥Ü‡≤Æ‡≤æ‡≤°‡≤ø ‚Üí ‡≤®‡≥ç‡≤Ø‡≤æ‡≤µ‡≤ø‡≤ó‡≥á‡≤ü‡≥ç ‡≤Æ‡≤æ‡≤°‡≤ø",
    ml: "‡¥µ‡¥ø‡¥≠‡¥æ‡¥ó‡¥Ç ‡¥§‡¥ø‡¥∞‡¥û‡µç‡¥û‡µÜ‡¥ü‡µÅ‡¥ï‡µç‡¥ï‡µÅ‡¥ï ‚Üí ‡¥∏‡µç‡¥•‡¥≤‡¥Ç ‡¥§‡¥ø‡¥∞‡¥û‡µç‡¥û‡µÜ‡¥ü‡µÅ‡¥ï‡µç‡¥ï‡µÅ‡¥ï ‚Üí ‡¥®‡¥æ‡¥µ‡¥ø‡¥ó‡µá‡¥±‡µç‡¥±‡µç ‡¥ö‡µÜ‡¥Ø‡µç‡¥Ø‡µÅ‡¥ï"
  },
  langLabel: {
    en: "Language:",
    te: "‡∞≠‡∞æ‡∞∑:",
    hi: "‡§≠‡§æ‡§∑‡§æ:",
    ta: "‡ÆÆ‡Øä‡Æ¥‡Æø:",
    kn: "‡≤≠‡≤æ‡≤∑‡≥Ü:",
    ml: "‡¥≠‡¥æ‡¥∑:"
  },
  searchPlaceholder: {
    en: "Search places, food, temples‚Ä¶",
    te: "‡∞∏‡±ç‡∞•‡∞≤‡∞æ‡∞≤‡±Å, ‡∞Ü‡∞π‡∞æ‡∞∞‡∞Ç, ‡∞Ü‡∞≤‡∞Ø‡∞æ‡∞≤‡∞®‡±Å ‡∞µ‡±Ü‡∞§‡∞ï‡∞Ç‡∞°‡∞ø...",
    hi: "‡§∏‡•ç‡§•‡§æ‡§®, ‡§≠‡•ã‡§ú‡§®, ‡§Æ‡§Ç‡§¶‡§ø‡§∞ ‡§ñ‡•ã‡§ú‡•á‡§Ç...",
    ta: "‡Æá‡Æü‡Æô‡Øç‡Æï‡Æ≥‡Øç, ‡Æâ‡Æ£‡Æµ‡ØÅ, ‡Æï‡Øã‡Æµ‡Æø‡Æ≤‡Øç‡Æï‡Æ≥‡Øà‡Æ§‡Øç ‡Æ§‡Øá‡Æü‡ØÅ‡Æô‡Øç‡Æï‡Æ≥‡Øç...",
    kn: "‡≤∏‡≥ç‡≤•‡≤≥‡≤ó‡≤≥‡≥Å, ‡≤Ü‡≤π‡≤æ‡≤∞, ‡≤¶‡≥á‡≤µ‡≤æ‡≤≤‡≤Ø‡≤ó‡≤≥‡≤®‡≥ç‡≤®‡≥Å ‡≤π‡≥Å‡≤°‡≥Å‡≤ï‡≤ø...",
    ml: "‡¥∏‡µç‡¥•‡¥≤‡¥ô‡µç‡¥ô‡µæ, ‡¥≠‡¥ï‡µç‡¥∑‡¥£‡¥Ç, ‡¥ï‡µç‡¥∑‡µá‡¥§‡µç‡¥∞‡¥ô‡µç‡¥ô‡µæ ‡¥é‡¥®‡µç‡¥®‡¥ø‡¥µ ‡¥§‡¥ø‡¥∞‡¥Ø‡µÅ‡¥ï..."
  },
  searchTitle: {
    en: "Search Results",
    te: "‡∞∂‡±ã‡∞ß‡∞® ‡∞´‡∞≤‡∞ø‡∞§‡∞æ‡∞≤‡±Å",
    hi: "‡§ñ‡•ã‡§ú ‡§™‡§∞‡§ø‡§£‡§æ‡§Æ",
    ta: "‡Æ§‡Øá‡Æü‡Æ≤‡Øç ‡ÆÆ‡ØÅ‡Æü‡Æø‡Æµ‡ØÅ‡Æï‡Æ≥‡Øç",
    kn: "‡≤π‡≥Å‡≤°‡≥Å‡≤ï‡≤æ‡≤ü ‡≤´‡≤≤‡≤ø‡≤§‡≤æ‡≤Ç‡≤∂‡≤ó‡≤≥‡≥Å",
    ml: "‡¥§‡¥ø‡¥∞‡¥Ø‡µΩ ‡¥´‡¥≤‡¥ô‡µç‡¥ô‡µæ"
  }
};

function updateStaticText() {
  const titleEl = document.getElementById("app-title");
  if(titleEl) titleEl.textContent = STATIC_TRANSLATIONS.title[currentLang] || STATIC_TRANSLATIONS.title.en;

  const subtitleEl = document.getElementById("app-subtitle");
  if(subtitleEl) subtitleEl.textContent = STATIC_TRANSLATIONS.subtitle[currentLang] || STATIC_TRANSLATIONS.subtitle.en;

  const langLabelEl = document.getElementById("lang-label");
  if(langLabelEl) langLabelEl.textContent = STATIC_TRANSLATIONS.langLabel[currentLang] || STATIC_TRANSLATIONS.langLabel.en;

  const searchInputEl = document.getElementById("searchInput");
  if(searchInputEl) searchInputEl.placeholder = STATIC_TRANSLATIONS.searchPlaceholder[currentLang] || STATIC_TRANSLATIONS.searchPlaceholder.en;

  const searchTitleEl = document.getElementById("search-title");
  if(searchTitleEl) searchTitleEl.textContent = STATIC_TRANSLATIONS.searchTitle[currentLang] || STATIC_TRANSLATIONS.searchTitle.en;
}

/* ================= LOAD DATA ================= */
fetch("locations.json")
  .then(res => res.json())
  .then(data => {
    locationsData = data;
    searchQuery = "";
    updateStaticText();
    document.getElementById("app").style.display = "block";
    document.getElementById("search-results").style.display = "none";
    renderApp();
  })
  .catch(err => console.error("Failed to load locations.json", err));

/* ================= CATEGORY LABELS ================= */
const CATEGORY_LABELS = {
  TEMPLE:{en:"Temples",te:"‡∞Ü‡∞≤‡∞Ø‡∞æ‡∞≤‡±Å",hi:"‡§Æ‡§Ç‡§¶‡§ø‡§∞",ta:"‡Æï‡Øã‡Æµ‡Æø‡Æ≤‡Øç‡Æï‡Æ≥‡Øç",kn:"‡≤¶‡≥á‡≤µ‡≤æ‡≤≤‡≤Ø‡≤ó‡≤≥‡≥Å",ml:"‡¥ï‡µç‡¥∑‡µá‡¥§‡µç‡¥∞‡¥ô‡µç‡¥ô‡µæ"},
  ASHRAM:{en:"Ashrams / Mathams",te:"‡∞Ü‡∞∂‡±ç‡∞∞‡∞Æ‡∞æ‡∞≤‡±Å / ‡∞Æ‡∞†‡∞æ‡∞≤‡±Å",hi:"‡§Ü‡§∂‡•ç‡§∞‡§Æ / ‡§Æ‡§†",ta:"‡ÆÜ‡Æö‡Æø‡Æ∞‡ÆÆ‡Æô‡Øç‡Æï‡Æ≥‡Øç / ‡ÆÆ‡Æü‡Æô‡Øç‡Æï‡Æ≥‡Øç",kn:"‡≤Ü‡≤∂‡≥ç‡≤∞‡≤Æ‡≤ó‡≤≥‡≥Å / ‡≤Æ‡≤†‡≤ó‡≤≥‡≥Å",ml:"‡¥Ü‡¥∂‡µç‡¥∞‡¥Æ‡¥ô‡µç‡¥ô‡µæ / ‡¥Æ‡¥†‡¥ô‡µç‡¥ô‡µæ"},
  ACCOMMODATION:{en:"Accommodation",te:"‡∞µ‡∞∏‡∞§‡∞ø",hi:"‡§Ü‡§µ‡§æ‡§∏",ta:"‡Æ§‡Æô‡Øç‡Æï‡ØÅ‡ÆÆ‡Æø‡Æü‡ÆÆ‡Øç",kn:"‡≤µ‡≤∏‡≤§‡≤ø",ml:"‡¥§‡¥æ‡¥Æ‡¥∏‡¥Ç"},
  FOOD:{en:"Food",te:"‡∞Ü‡∞π‡∞æ‡∞∞‡∞Ç",hi:"‡§≠‡•ã‡§ú‡§®",ta:"‡Æâ‡Æ£‡Æµ‡ØÅ",kn:"‡≤Ü‡≤π‡≤æ‡≤∞",ml:"‡¥≠‡¥ï‡µç‡¥∑‡¥£‡¥Ç"},
  FACILITY:{en:"Facilities",te:"‡∞∏‡±å‡∞ï‡∞∞‡±ç‡∞Ø‡∞æ‡∞≤‡±Å",hi:"‡§∏‡•Å‡§µ‡§ø‡§ß‡§æ‡§è‡§Ç",ta:"‡Æµ‡Æö‡Æ§‡Æø‡Æï‡Æ≥‡Øç",kn:"‡≤∏‡≥å‡≤≤‡≤≠‡≥ç‡≤Ø‡≤ó‡≤≥‡≥Å",ml:"‡¥∏‡µó‡¥ï‡¥∞‡µç‡¥Ø‡¥ô‡µç‡¥ô‡µæ"},
  TRANSPORT:{en:"Transport",te:"‡∞∞‡∞µ‡∞æ‡∞£‡∞æ",hi:"‡§™‡§∞‡§ø‡§µ‡§π‡§®",ta:"‡Æ™‡Øã‡Æï‡Øç‡Æï‡ØÅ‡Æµ‡Æ∞‡Æ§‡Øç‡Æ§‡ØÅ",kn:"‡≤∏‡≤æ‡≤∞‡≤ø‡≤ó‡≥Ü",ml:"‡¥ó‡¥§‡¥æ‡¥ó‡¥§‡¥Ç"},
  UTILITY:{en:"Utilities",te:"‡∞∏‡±á‡∞µ‡∞≤‡±Å",hi:"‡§∏‡•á‡§µ‡§æ‡§è‡§Ç",ta:"‡Æö‡Øá‡Æµ‡Øà‡Æï‡Æ≥‡Øç",kn:"‡≤∏‡≥á‡≤µ‡≥Ü‡≤ó‡≤≥‡≥Å",ml:"‡¥∏‡µá‡¥µ‡¥®‡¥ô‡µç‡¥ô‡µæ"},
  TOURIST_SPOT:{en:"Tourist Spots",te:"‡∞™‡∞∞‡±ç‡∞Ø‡∞æ‡∞ü‡∞ï ‡∞™‡±ç‡∞∞‡∞æ‡∞Ç‡∞§‡∞æ‡∞≤‡±Å",hi:"‡§™‡§∞‡•ç‡§Ø‡§ü‡§® ‡§∏‡•ç‡§•‡§≤",ta:"‡Æö‡ØÅ‡Æ±‡Øç‡Æ±‡ØÅ‡Æ≤‡Ææ ‡Æá‡Æü‡Æô‡Øç‡Æï‡Æ≥‡Øç",kn:"‡≤™‡≤∞‡≥ç‡≤Ø‡≤ü‡≤®‡≤æ ‡≤∏‡≥ç‡≤•‡≤≥‡≤ó‡≤≥‡≥Å",ml:"‡¥∏‡¥û‡µç‡¥ö‡¥æ‡¥∞ ‡¥ï‡µá‡¥®‡µç‡¥¶‡µç‡¥∞‡¥ô‡µç‡¥ô‡µæ"}
};

/* ================= BUTTON LABELS ================= */
const BUTTON_LABELS = {
  openMaps: {
    en: "Open in Google Maps",
    te: "‡∞ó‡±Ç‡∞ó‡±Å‡∞≤‡±ç ‡∞Æ‡±ç‡∞Ø‡∞æ‡∞™‡±ç‡∞∏‡±ç‚Äå‡∞≤‡±ã ‡∞§‡±Ü‡∞∞‡∞µ‡∞Ç‡∞°‡∞ø",
    hi: "‡§ó‡•Ç‡§ó‡§≤ ‡§Æ‡•à‡§™‡•ç‡§∏ ‡§Æ‡•á‡§Ç ‡§ñ‡•ã‡§≤‡•á‡§Ç",
    ta: "‡Æï‡ØÇ‡Æï‡ØÅ‡Æ≥‡Øç ‡ÆÆ‡Øá‡Æ™‡Øç‡Æ∏‡Æø‡Æ≤‡Øç ‡Æ§‡Æø‡Æ±‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç",
    kn: "‡≤ó‡≥Ç‡≤ó‡≤≤‡≥ç ‡≤Æ‡≥ç‡≤Ø‡≤æ‡≤™‡≥ç‡≤∏‡≥ç‚Äå‡≤®‡≤≤‡≥ç‡≤≤‡≤ø ‡≤§‡≥Ü‡≤∞‡≥Ü‡≤Ø‡≤ø‡≤∞‡≤ø",
    ml: "‡¥ó‡µÇ‡¥ó‡¥ø‡µæ ‡¥Æ‡¥æ‡¥™‡µç‡¥∏‡¥ø‡µΩ ‡¥§‡µÅ‡¥±‡¥ï‡µç‡¥ï‡µÅ‡¥ï"
  },
  navigate: {
    en: "Navigate",
    te: "‡∞®‡∞æ‡∞µ‡∞ø‡∞ó‡±á‡∞ü‡±ç ‡∞ö‡±á‡∞Ø‡∞Ç‡∞°‡∞ø",
    hi: "‡§®‡•á‡§µ‡§ø‡§ó‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç",
    ta: "‡Æµ‡Æ¥‡Æø‡Æï‡Ææ‡Æü‡Øç‡Æü‡ØÅ",
    kn: "‡≤®‡≥ç‡≤Ø‡≤æ‡≤µ‡≤ø‡≤ó‡≥á‡≤ü‡≥ç ‡≤Æ‡≤æ‡≤°‡≤ø",
    ml: "‡¥®‡¥æ‡¥µ‡¥ø‡¥ó‡µá‡¥±‡µç‡¥±‡µç ‡¥ö‡µÜ‡¥Ø‡µç‡¥Ø‡µÅ‡¥ï"
  }
};

/* ================= SMART SEARCH MATCH ================= */
function matchesSearch(l) {
  if (!searchQuery) return true;

  const query = searchQuery.toLowerCase();
  const allLanguages = ['en', 'te', 'hi', 'ta', 'kn', 'ml'];
  
  let searchableText = "";
  searchableText += (l["display name"] || "").toLowerCase() + " ";
  
  allLanguages.forEach(lang => {
    searchableText += (l["name_" + lang] || "").toLowerCase() + " ";
  });
  
  allLanguages.forEach(lang => {
    const catLabel = CATEGORY_LABELS[l.category]?.[lang];
    if (catLabel) {
      searchableText += catLabel.toLowerCase() + " ";
    }
  });
  
  searchableText += (l.category || "").toLowerCase().replace(/_/g, " ") + " ";
  
  allLanguages.forEach(lang => {
    searchableText += (l["description_" + lang] || "").toLowerCase() + " ";
  });
  
  return searchableText.includes(query);
}

/* ================= FREE DARSHAN (STANDALONE) ================= */
function renderFreeDarshan() {
  const container = document.getElementById("free-darshan-container");
  container.innerHTML = "";

  const free = locationsData.find(
    l => l.category === "FREE_DARSHAN_COUNTER"
  );
  if (!free) return;

  const btn = document.createElement("button");
  btn.textContent =
    free["name_" + currentLang] || free["display name"];

  btn.onclick = () =>
  window.open(
    `https://www.google.com/maps/search/?api=1&query=${free.latitude},${free.longitude}`,
    "_blank"
  );

  btn.style.padding = "12px 16px";
  btn.style.fontSize = "16px";
  btn.style.fontWeight = "bold";
  btn.style.cursor = "pointer";

  container.appendChild(btn);
}

/* ================= BROWSE MODE ================= */
function renderApp() {
  renderFreeDarshan();

  const app = document.getElementById("app");
  app.innerHTML = "";
  app.style.display = "block";
  document.getElementById("search-results").style.display = "none";

  const CATEGORY_ICONS = {
    TEMPLE: "üõï",
    ASHRAM: "üïâÔ∏è",
    ACCOMMODATION: "üè®",
    FOOD: "üçõ",
    FACILITY: "üè•",
    TRANSPORT: "üöå",
    UTILITY: "üîß",
    TOURIST_SPOT: "üèûÔ∏è"
  };

  const grouped = {};
  locationsData
    .filter(l => l.category !== "FREE_DARSHAN_COUNTER")
    .forEach(l => (grouped[l.category] ||= []).push(l));

  for (const cat in grouped) {
    const section = document.createElement("section");
    const h = document.createElement("h2");
    
    const iconSpan = document.createElement("span");
    iconSpan.textContent = CATEGORY_ICONS[cat] || "üìç";
    iconSpan.style.fontSize = "24px";
    iconSpan.style.marginRight = "12px";
    h.appendChild(iconSpan);
    
    const textNode = document.createTextNode(CATEGORY_LABELS[cat]?.[currentLang] || cat);
    h.appendChild(textNode);
    
    h.style.cursor = "pointer";

    const ul = document.createElement("ul");
    ul.style.display = "none";

    h.onclick = () => {
      const isOpen = ul.style.display === "block";
      document.querySelectorAll("#app ul").forEach(u => u.style.display = "none");
      document.querySelectorAll("#app ul div").forEach(d => d.style.display = "none");
      ul.style.display = isOpen ? "none" : "block";
    };

    grouped[cat].forEach(l => {
      const li = document.createElement("li");

      const name = document.createElement("strong");
      name.textContent = l["name_" + currentLang] || l["display name"];
      name.style.cursor = "pointer";

      const details = document.createElement("div");
      details.style.display = "none";

      if (l["description_" + currentLang]) {
        const desc = document.createElement("p");
        desc.textContent = l["description_" + currentLang];
        desc.style.margin = "6px 0";
        details.append(desc);
      }
      
      const btn = document.createElement("button");
      btn.textContent = BUTTON_LABELS.navigate[currentLang];
      
      btn.onclick = () =>
        window.open(
          `https://www.google.com/maps/search/?api=1&query=${l.latitude},${l.longitude}`,
          "_blank"
        );

      details.append(btn);

      name.onclick = () => {
        const isOpen = details.style.display === "block";
        ul.querySelectorAll("div").forEach(d => d.style.display = "none");
        details.style.display = isOpen ? "none" : "block";
      };

      li.append(name, details);
      ul.append(li);
    });

    section.append(h, ul, document.createElement("hr"));
    app.append(section);
  }
}

/* ================= SEARCH MODE ================= */
function renderSearchResults() {
  const list = document.getElementById("search-list");
  list.innerHTML = "";

  const results = locationsData
    .filter(l => l.category !== "FREE_DARSHAN_COUNTER")
    .filter(matchesSearch);

  if (results.length === 0) {
    list.innerHTML = "<li>No matching locations found</li>";
  } else {
    results.forEach(l => {
      const li = document.createElement("li");

      const name = document.createElement("strong");
      name.textContent = l["name_" + currentLang] || l["display name"];
      name.style.cursor = "pointer";

      const details = document.createElement("div");
      details.style.display = "none";

      if (l["description_" + currentLang]) {
        const desc = document.createElement("p");
        desc.textContent = l["description_" + currentLang];
        desc.style.margin = "6px 0";
        details.append(desc);
      }

      const btn = document.createElement("button");
      btn.textContent = BUTTON_LABELS.navigate[currentLang];
      
      btn.onclick = () =>
        window.open(
          `https://www.google.com/maps/search/?api=1&query=${l.latitude},${l.longitude}`,
          "_blank"
        );

      details.append(btn);

      name.onclick = () => {
        const isOpen = details.style.display === "block";
        document.querySelectorAll("#search-list div").forEach(d => d.style.display = "none");
        details.style.display = isOpen ? "none" : "block";
      };

      li.append(name, details);
      list.append(li);
    });
  }

  document.getElementById("app").style.display = "none";
  document.getElementById("search-results").style.display = "block";
}

/* ================= EVENTS ================= */
document.getElementById("lang").addEventListener("change", e => {
  currentLang = e.target.value;
  updateStaticText();
  searchQuery ? renderSearchResults() : renderApp();
});

const searchInput = document.getElementById("searchInput");
const clearBtn = document.getElementById("clearSearch");

searchInput.addEventListener("input", e => {
  searchQuery = e.target.value.trim().toLowerCase();
  clearBtn.style.display = searchQuery ? "flex" : "none";

  const hero = document.getElementById("hero-section");

  if (searchQuery) {
    if (hero) hero.style.display = "none";   // üî¥ HIDE IMAGE
    renderSearchResults();
  } else {
    if (hero) hero.style.display = "block";  // üü¢ SHOW IMAGE
    renderApp();
  }
});


clearBtn.addEventListener("click", () => {
  const hero = document.getElementById("hero-section");

  searchInput.value = "";
  searchQuery = "";
  clearBtn.style.display = "none";

  if (hero) hero.style.display = "block"; // üü¢ SHOW IMAGE AGAIN

  renderApp();
  searchInput.focus();
});


/* ================= BACK TO TOP VISIBILITY ================= */
document.addEventListener("DOMContentLoaded", () => {
  const backToTopBtn = document.getElementById("back-to-top");
  if (!backToTopBtn) return;
  backToTopBtn.style.display = "none";
  window.addEventListener("scroll", () => {
    if (window.scrollY > 150) {
      backToTopBtn.style.display = "flex"; 
    } else {
      backToTopBtn.style.display = "none";
    }
  });
});
</script>
</body>
</html>